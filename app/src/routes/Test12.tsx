import React, { useState } from "react";

// dummy data received by props
const codeList = [
  [
    "",
    "",
    "",
    "M000000",
    0,
    "",
    "項目0",
    1,
    "0",
    "3",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "1",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000001",
    0,
    "",
    "項目1",
    1,
    "1",
    "2",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "1",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000002",
    0,
    "",
    "項目2",
    1,
    "2",
    "",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "2",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000003",
    0,
    "",
    "項目3",
    1,
    "",
    "2",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "3",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000004",
    0,
    "",
    "項目4",
    1,
    "",
    "2",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "4",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000005",
    0,
    "",
    "項目5",
    1,
    "5",
    "4",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "5",
    "0",
    "0",
  ],
  [
    "",
    "",
    "",
    "M000006",
    0,
    "",
    "項目6",
    1,
    "8",
    "10",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
  ],
  [
    "",
    "",
    "",
    "M000007",
    0,
    "",
    "項目7",
    1,
    "9",
    "",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
  ],
  [
    "",
    "",
    "",
    "M000007",
    0,
    "",
    "項目8",
    1,
    "10",
    "",
    false,
    false,
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
  ],
];

type item = {
  id: number;
  name?: string | number | boolean;
  parent?: string | number | boolean;
  child?: string | number | boolean;
  children: item[];
};

console.log(codeList);

export default () => {
  const list0 = codeList.filter((row) => row[6] !== "");
  const list1 = list0.map((row, index): item => {
    return {
      id: index,
      name: row[6],
      parent: row[8],
      child: row[9],
      children: [],
    };
  });

  const list2 = list1.filter((row) => {
    const child = row.child;
    if (child !== "") {
      const parent = list1.find((row) => row.parent === child);
      parent?.children.push({
        id: row.id,
        name: row.name,
        parent: row.parent,
        child: row.parent,
        children: row.children,
      });
      return false;
    } else {
      return true;
    }
  });

  console.log(list2);

  return <></>;
};
